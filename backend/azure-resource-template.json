{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "sites_azurefunctioncount_name": {
      "defaultValue": "azurefunctioncount",
      "type": "String"
    },
    "serverfarms_ASP_azurefunctioncount_2cbf_externalid": {
      "defaultValue": "/subscriptions/4a1548fb-fe82-4a7b-99ec-76f4afe6bf28/resourceGroups/azurefunctioncount/providers/Microsoft.Web/serverfarms/ASP-azurefunctioncount-2cbf",
      "type": "String"
    },
    "databaseAccounts_databasecounter_name": {
      "defaultValue": "databasecounter",
      "type": "String"
    }
  },
  "variables": {},
  "resources": [
    {
      "type": "Microsoft.Web/sites",
      "apiVersion": "2022-09-01",
      "name": "[parameters('sites_azurefunctioncount_name')]",
      "location": "West Europe",
      "tags": {
        "hidden-link: /app-insights-resource-id": "/subscriptions/4a1548fb-fe82-4a7b-99ec-76f4afe6bf28/resourceGroups/azurefunctioncount/providers/microsoft.insights/components/azurefunctioncount",
        "hidden-link: /app-insights-instrumentation-key": "a4c02966-7e06-4e35-9c20-8d38738fe555",
        "hidden-link: /app-insights-conn-string": "InstrumentationKey=a4c02966-7e06-4e35-9c20-8d38738fe555;IngestionEndpoint=https://westeurope-5.in.applicationinsights.azure.com/;LiveEndpoint=https://westeurope.livediagnostics.monitor.azure.com/"
      },
      "kind": "functionapp,linux",
      "properties": {
        "enabled": true,
        "hostNameSslStates": [
          {
            "name": "[concat(parameters('sites_azurefunctioncount_name'), '.azurewebsites.net')]",
            "sslState": "Disabled",
            "hostType": "Standard"
          },
          {
            "name": "[concat(parameters('sites_azurefunctioncount_name'), '.scm.azurewebsites.net')]",
            "sslState": "Disabled",
            "hostType": "Repository"
          }
        ],
        "serverFarmId": "[parameters('serverfarms_ASP_azurefunctioncount_2cbf_externalid')]",
        "reserved": true,
        "isXenon": false,
        "hyperV": false,
        "vnetRouteAllEnabled": false,
        "vnetImagePullEnabled": false,
        "vnetContentShareEnabled": false,
        "siteConfig": {
          "numberOfWorkers": 1,
          "linuxFxVersion": "PYTHON|3.10",
          "acrUseManagedIdentityCreds": false,
          "alwaysOn": false,
          "http20Enabled": false,
          "functionAppScaleLimit": 200,
          "minimumElasticInstanceCount": 0
        },
        "scmSiteAlsoStopped": false,
        "clientAffinityEnabled": false,
        "clientCertEnabled": false,
        "clientCertMode": "Required",
        "hostNamesDisabled": false,
        "customDomainVerificationId": "905AE57B2E78B5C27E16111B32E4A678CF9B41C83DD2BEAD5B2D8B6C233D62D3",
        "kind": null,
        "cloningInfo": null,
        "containerSize": 128,
        "dailyMemoryTimeQuota": 0,
        "httpsOnly": false,
        "redundancyMode": "None",
        "scmMinTlsVersion": "1.2",
        "scmType": "None",
        "skipCustomDomainVerification": false,
        "sourceControl": null,
        "microService": "worker",
        "identity": null,
        "identityRef": null,
        "systemData": null
      },
      "dependsOn": [
        "[resourceId('Microsoft.Web/serverfarms', 'ASP-azurefunctioncount-2cbf')]"
      ]
    },
    {
      "type": "Microsoft.Web/serverfarms",
      "apiVersion": "2022-09-01",
      "name": "ASP-azurefunctioncount-2cbf",
      "location": "West Europe",
      "tags": {},
      "sku": {
        "name": "Y1",
        "tier": "Dynamic",
        "size": "Y1",
        "family": "Y",
        "capacity": 0
      },
      "properties": {
        "name": "ASP-azurefunctioncount-2cbf",
        "workerTierName": "0",
        "numberOfWorkers": 0,
        "hostingEnvironmentProfile": null,
        "perSiteScaling": false,
        "maximumElasticWorkerCount": 0,
        "maximumNumberOfWorkers": 0,
        "autoscaleEnabled": false,
        "adminSiteName": null,
        "hostingEnvironmentId": null,
        "vnetName": null,
        "vnetResourceGroup": null,
        "vnetSubnetName": null,
        "dscSource": null,
        "kind": null,
        "hyperV": false,
        "clusterSettings": null,
        "quotaSettings": null,
        "reserved": false,
        "isXenon": false,
        "hyperVWorkers": 0,
        "dscResourcesToCheck": null,
        "dscResourcesToInstall": null,
        "dscResourcesToUninstall": null,
        "systemData": null
      }
    },
    {
      "type": "Microsoft.DocumentDB/databaseAccounts",
      "apiVersion": "2023-04-15",
      "name": "[parameters('databaseAccounts_databasecounter_name')]",
      "location": "West Europe",
      "tags": {
        "defaultExperience": "Azure Table",
        "hidden-cosmos-mmspecial": ""
      },
      "kind": "GlobalDocumentDB",
      "identity": {
        "type": "None"
      },
      "properties": {
        "databaseAccountOfferType": "Standard",
        "consistencyPolicy": {
          "defaultConsistencyLevel": "BoundedStaleness",
          "maxStalenessPrefix": 100,
          "maxIntervalInSeconds": 5
        },
        "locations": [
          {
            "locationName": "West Europe",
            "failoverPriority": 0
          }
        ],
        "databaseAccountOfferThroughput": 400,
        "enableMultipleWriteLocations": false,
        "isVirtualNetworkFilterEnabled": false,
        "enableAutomaticFailover": true,
        "enableAnalyticalStorage": false,
        "backupPolicy": null,
        "cors": {
          "allowedOrigins": *,
          "allowedMethods": [
            "GET",
            "POST",
            "PUT",
            "PATCH",
            "DELETE",
            "HEAD",
            "OPTIONS"
          ],
          "allowedHeaders": [],
          "exposedHeaders": [],
          "maxAgeInSeconds": null
        },
        "ipRules": [],
        "virtualNetworkRules": [],
        "publicNetworkAccess": "Enabled",
        "enableFreeTier": false,
        "enablePurgeProtection": false,
        "diagnosticSettings": [],
        "enableAnalyticalStorageEvaluation": false,
        "queryRuntimeEndpoint": null,
        "enableShortTermRetention": false,
        "keyVaultKeyUri": null,
        "systemData": null
      }
    }
  ]
}
